# 分享标题
大家好，几天给大家带来的分享是 从矩阵走入 WebGL 世界。

# 自我介绍
嗯，大家可能不认识我，我叫陈剑鑫，大家可以叫我jason，也可以叫我JC，
是一名来自UC的前端开发工程师，
现在是主要负责活动营销方面的业务，对的，像那些朋友圈里经常刷屏的小游戏、酷炫的视觉效果，我们是做类似这样的项目的
沉迷于可编程动画、webgl等图形技术等前端开发。

# 矩阵有什么用
在我们开始接触矩阵之前，先来看看矩阵到底有什么用，给我们带来了什么
下面是我随意列举的几个项目的录屏，来感受下矩阵给项目带来的改变

1、是一个音乐类相关的节目，loading采用了一个氛围灯的效果。这个效果是纯canvas 2d原生api实现的，
用高等数学的知识生成球面坐标点，然后用矩阵使坐标点发生旋转，代码体积也就只有3k的样子，想想看如果这里换成图片至少20k

2、这是一个项目的抽奖页面，虽然说没用这个效果不会说，抽不了奖啊，对活动的功能没有任何影响，但是大家在看到这样的一个抽奖页面是不是就会下意识的会对这个活动的更加信任， 活动的信誉度提高，就是感觉能抽到奖，通过这些细节提高自己项目的档次

3、这个是俄罗斯奥运会期间的一个活动，这个loading也是用纯canvas 2d原生api实现的，也是根据一个轮廓样条生成这个模型的三维坐标点，然后进行相应的旋转 玩法主线是在未来的奥运场馆里面通过寻找一个能量石来为俄罗斯选手加油，场景里面有各种事件埋点，其中某些埋点会间接的告诉你最终那个能量石的具体位置。

假如你不知道用矩阵，面对这类效果，可能大多数人的反应都是“设计师切逐帧给我”，但是这绝不是一个好的实现。特别是在网络环境并不是非常好的市场上，这些效果的实现代码只有3到4K

# 矩阵
那些就是矩阵给我们带来的惊喜，是不是还挺好玩的
可能有些人会说，我们不做营销活动业务，矩阵和我们完全没必要用啊，没交集啊，用不到啊，挤地铁的时候用不到，逛淘宝的时候用不到。
其实啊矩阵和我们还是有很多交集的，大家在不经意间用到过她们，只不过是浏览器把它们封装的更简单了，你感觉不到你正在使用矩阵。
最常用的css3 transform
# css3 transform
transform和矩阵有着千丝万缕的联系，了解过的童鞋可能知道transform的各种变换效果在底层都是由matrix来实现的。
正因为底层是由矩阵实现的，所以transform 2d 给我们提供了直接传入一个矩阵的方法，matrix
我们知道除了css 2d，css3还给我们带来了三维能力，其中最然我们震惊和激动的就是transform三维变换里面的三维旋转功能了，
例如这下面的这个欢快的立方体。这里要多讲一点的是 数据里面描述一个物体在三维空间里面的旋转姿态一般有三种方法，
第一个不用说咯，矩阵来描述，因为都说了这些东西最后都会转成矩阵的嘛。还有一个就是欧拉角的形式，另一个是四元数的形式。
相比与矩阵的形式后面两个的描述要更直观一些，欧拉角听起来好像很高大上的感觉，其实它就是我们常用的rotateX｜Y｜Z系列，描述的就是一个物体围绕自身的坐标轴旋转多少角度
四元数这名字听起来不伦不类的，听到名字就不喜欢更它玩的感觉，其实四元数就大概可以对应到rotate3d，rotate3d大家用到的可能相对会比较少，很多晚上的技术文章对他的解释也是有误的，
rotate3d接受四个参数嘛，很多文章说这四个参数前三个是0到1之间的数字，第四个参数是角度。这样说是错误的，或者说只说对了四分之一，因为rotate3d是基于四元数的，
他前面的三个参数实际上是一个方向向量，既然是方向向量就没有什么0到1之间的这么一说了对吧，任意有限的数值。浏览器在接收到rotate3d的参数后是先对传入的那个向量进行归一化，
然后再将角度除以2之后正弦余弦，这就不详细往下讲了哈，只要记住前面三个参数是一个向量就好了
除此之外还有svg里面也有矩阵的身影
canvas里面也有矩阵的身影
所以综上可知，矩阵在现代浏览器中非常重要。没有他你会感觉前端顿时变成了一个没有爱的世界

# 矩阵是什么
讲了这么久矩阵，还没看到矩阵到底长什么样的对吧，接下来我们来一步一步揭开矩阵的面纱
这就是矩阵，长得方方正正的，有点微胖。国字脸，不说了等下不要把它弄生气了。
根据刚才的实例我们也都知道了，他是用来描述几何空间内的放射变换的。

我们用到最多的就是矩阵乘法，矩阵到底是怎么改变坐标点位置的呢，就是利用矩阵乘法
矩阵的乘法有几个概念就是a行b列矩阵乘以b行c列最后会得到a行c列矩阵，有点绕口，脑回路走一走。
还有一个就是矩阵乘法不符合乘法交换律

# 价值
有些同学可能会想，这些东西浏览器都帮我们处理好了，我们为什么还要学习了解矩阵呢。研究他的价值在哪里？
开头的几个实例就说明了它的价值，因为在很多情况下浏览器并没有提供三维矩阵的操作方法,例如canvas 2d啊甚至svg都不支持3d变换
所以想要完成那样的好玩的效果，深入了解矩阵就很有必要了。
为了能做出更绚丽的动画，我们继续来深入了解矩阵
学什么都得从最简单的开始，就像我们以前学向量要先学单位向量一样，先来看看单位矩阵
对角线全为1，他有什么作用呢，看下面这个例子，发现它不起任何作用，这也正和他的名字一样，单位嘛，就像单位向量乘以任何向量得到的还是那个向量

这里我快速的列出了我们比较常见的矩阵，由于时间关系我就不一一推导了哈，我挑其中一个比较有代表性的快速推导一下，rotateZ
绕Z轴旋转，因为我们知道坐标点绕哪个轴旋转，那么坐标点的该轴的分量保持不变，这是常识哈，那绕Z轴旋转就可以简化到x－y的二维笛卡尔坐标系上讨论了，
这样一来就很好推了，xy绕Z轴旋转β角度后到了x`y`，根据单位圆，我们得到这样的式子

# 配合webgl使用矩阵
看到大家都听懂了的样子好开心。

没办法因为他是可编程渲染管线吗，事儿本来就多

# VR 
为什么我们人可以感受到三维世界，是因为我们是用两个眼睛去观察的，可以做个实验，你用手遮住一个眼睛，用另外一个眼睛观察你身边的一个细物体，用你的一个手指去触碰它，你会感觉我快要触碰到它了啊，但是你再往前伸一点你才真正的碰到它，这就是因为你只用一个眼睛去观察它，丢失了一个维度的信息，让你对深度不敏感了。同理从屏幕里面出来的三维图像，在屏幕这个过程就已经丢失了一个维度的信息，所以，我们想要还原这个信息就应该，把丢失的这个维度找回来。

到这个时候是不是发现矩阵可以给你整个世界，还要什么自行车啊